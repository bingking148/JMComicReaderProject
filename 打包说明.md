# JMComicReader EXE æ‰“åŒ…è¯´æ˜

## ğŸ“¦ ç®€ä»‹

æœ¬å·¥å…·ä½¿ç”¨ Nuitka å°† Python é¡¹ç›®æ‰“åŒ…ä¸ºç‹¬ç«‹çš„ EXE å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ— éœ€å®‰è£… Python ç¯å¢ƒå³å¯è¿è¡Œã€‚

---

## ğŸ›  ç¯å¢ƒè¦æ±‚

### å¿…éœ€è½¯ä»¶
- **Python 3.8+** - å¼€å‘ç¯å¢ƒ
- **Windows 7+** - è¿è¡Œç¯å¢ƒ

### å¯é€‰è½¯ä»¶
- **Git** - ç”¨äºå…‹éš†é¡¹ç›®ï¼ˆæ¨èï¼‰

---

## ğŸ“¦ ä¸€é”®æ‰“åŒ…ï¼ˆæ¨èï¼‰

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ‰“åŒ…è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

**é€‚ç”¨äººç¾¤**ï¼šæ‰€æœ‰ç”¨æˆ·

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/bingking148/JMComicReaderProject.git
cd JMComicReaderProject

# 2. å®‰è£…æ‰“åŒ…ä¾èµ–
pip install -r requirements.txt

# 3. è¿è¡Œæ‰“åŒ…è„šæœ¬
python build_exe.py
```

**æ‰“åŒ…å®Œæˆå**ï¼š
- EXE æ–‡ä»¶ä½ç½®ï¼š`dist/JMComicReader.exe`
- æ–‡ä»¶å¤§å°ï¼šçº¦ 40-60 MB
- å¯åŠ¨æ–¹å¼ï¼šåŒå‡» `JMComicReader.exe`

---

## ğŸš€ æ‰‹åŠ¨æ‰“åŒ…ï¼ˆè¿›é˜¶ï¼‰

### æ­¥éª¤ 1ï¼šå®‰è£… Nuitka

```bash
pip install nuitka zstandard
```

### æ­¥éª¤ 2ï¼šæ‰§è¡Œæ‰“åŒ…å‘½ä»¤

```bash
# Windows PowerShell
python -m nuitka ^
  --standalone ^
  --onefile ^
  --windows-console-mode=disable ^
  --assume-yes-for-downloads ^
  --plugin-enable=numpy ^
  --enable-plugin=pyside6 ^
  --output-dir=build ^
  --output-filename=dist/JMComicReader.exe ^
  --include-data-files=frontend ^
  --include-data-files=backend ^
  --file-reference=build.spec
```

### æ­¥éª¤ 3ï¼šæŸ¥çœ‹ç»“æœ

æ‰“åŒ…æˆåŠŸåï¼Œ`dist` ç›®å½•ä¸‹ä¼šç”Ÿæˆï¼š
- `JMComicReader.exe` - ä¸»ç¨‹åº
- `JMComicReader.dist` - ä¸´æ—¶æ–‡ä»¶ï¼ˆå¯åˆ é™¤ï¼‰

---

## ğŸ“ æ‰“åŒ…æ–‡ä»¶è¯´æ˜

### build.specï¼ˆå¯é€‰ï¼‰

è¿™æ˜¯ Nuitka çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è‡ªå®šä¹‰æ‰“åŒ…é€‰é¡¹ï¼š

```python
# Mode æ¨¡å¼é€‰æ‹©ï¼š
# - standaloneexefile: å¯åŠ¨æœ€å¿«ï¼Œä½“ç§¯æœ€å°ï¼ˆæ¨èï¼‰
# - onefile: å¯åŠ¨è¾ƒå¿«ï¼Œä½†é¦–æ¬¡è¿è¡Œæ—¶åŠ è½½ç½‘é¡µèµ„æºæ…¢

# ä¼˜åŒ–é€‰é¡¹ï¼š
# --O2: ä¼˜åŒ–çº§åˆ«ï¼ˆå¹³è¡¡æ€§èƒ½å’Œä½“ç§¯ï¼‰
# --lto: é“¾æ¥æ—¶ä¼˜åŒ–ï¼ˆå‡å°ä½“ç§¯ï¼‰
# --enable-plugin=pgo: å¼•å¯¼ä¼˜åŒ–ï¼ˆé¦–æ¬¡æ‰“åŒ…æ…¢ï¼Œåç»­å¿«ï¼‰
```

---

## ğŸ¯ ä½¿ç”¨è¯´æ˜

### 1. åˆ†å‘æ–¹å¼

**æ–¹å¼ä¸€ï¼šç›´æ¥åˆ†å‘**
1. æ‰“åŒ…æ•´ä¸ª `dist` æ–‡ä»¶å¤¹
2. å‹ç¼©ä¸º ZIPï¼ˆå¯é€‰ï¼‰
3. å‘é€ç»™ç”¨æˆ·

**æ–¹å¼äºŒï¼šå®‰è£…åŒ…**
1. å°† `JMComicReader.exe` å’Œæ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ä¸€èµ·æ‰“åŒ…
2. ç”¨æˆ·æä¾›å®‰è£…å‘å¯¼

### 2. é¦–æ¬¡è¿è¡Œ

1. åŒå‡» `JMComicReader.exe`
2. ç¨‹åºä¼šè‡ªåŠ¨åœ¨å½“å‰ç›®å½•åˆ›å»ºï¼š
   - `backend/comics.db` - æ•°æ®åº“æ–‡ä»¶
   - `backend/jm_option.yml` - JMé…ç½®æ–‡ä»¶
   - `TempCache/` - ç¼“å­˜ç›®å½•
   - `DownloadedComics/` - ä¸‹è½½ç›®å½•
3. è®¿é—® `http://localhost:5000` å¼€å§‹ä½¿ç”¨

### 3. ç«¯å£å ç”¨

å¦‚æœæç¤ºç«¯å£ 5000 è¢«å ç”¨ï¼š

```bash
# Windows PowerShell
netstat -ano | findstr :5000

# æˆ–ä½¿ç”¨å‘½ä»¤æç¤ºç¬¦
netstat -ano | findstr ":5000"
```

æ‰¾åˆ°å ç”¨è¿›ç¨‹åï¼š
```bash
# ç»“æŸè¿›ç¨‹ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
taskkill /F /IM <è¿›ç¨‹å>

# æˆ–ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ backend/app.py æˆ– backend/jm_option.yml
```

### 4. æ•°æ®å…¼å®¹æ€§

**æ³¨æ„**ï¼šä¸åŒæ‰“åŒ…ç‰ˆæœ¬ä¹‹é—´çš„æ•°æ®åº“æ–‡ä»¶ä¸å…¼å®¹ï¼

å¦‚æœç”¨æˆ·ä» EXE V1 å‡çº§åˆ° EXE V2ï¼š
- æ•°æ®åº“æ–‡ä»¶ä¸é€šç”¨
- éœ€è¦è¿ç§»æ•°æ®æˆ–é‡æ–°ä¸‹è½½

**å»ºè®®**ï¼š
1. åœ¨æ–°ç‰ˆæœ¬ä¸­æ·»åŠ æ•°æ®åº“è¿ç§»åŠŸèƒ½
2. æˆ–å¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒå¯¼å…¥/å¯¼å‡º
3. æˆ–æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·ç‰ˆæœ¬ä¸å…¼å®¹

### 5. æ–‡ä»¶å¤§å°ä¼˜åŒ–

**å½“å‰å¤§å°**ï¼šçº¦ 40-60 MB

**å¦‚æœéœ€è¦æ›´å°çš„EXE**ï¼š

1. **å¯ç”¨ UPX å‹ç¼©**
   ```bash
   pip install upx
   upx --best --lzma dist/JMComicReader.exe
   ```
   - å¯å‡å°‘ 30-50% ä½“ç§¯

2. **ä½¿ç”¨ PyInstaller + UPX**
   ```bash
   pip install pyinstaller
   pyinstaller --onefile --windowed --add-data "frontend;backend" start.py
   upx --best --lzma dist/JMComicReader.exe
   ```

3. **æ’é™¤ä¸å¿…è¦çš„æ¨¡å—**
   - åœ¨ `build.spec` ä¸­è®¾ç½® `excludes` æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
   - ä¾‹å¦‚ï¼šæµ‹è¯•æ–‡ä»¶ã€æ–‡æ¡£ç­‰

### 6. å¸¸è§é—®é¢˜

#### Q1: æ‰“åŒ…å¤±è´¥ï¼Œæç¤ºç¼ºå°‘æ¨¡å—ï¼Ÿ

**åŸå› **ï¼šNuitka éœ€è¦ç¼–è¯‘æŸäº›ä¾èµ–åº“

**è§£å†³**ï¼š
1. å®‰è£…å¯¹åº”ä¾èµ–ï¼š`pip install <æ¨¡å—å>`
2. æˆ–åœ¨ `build.spec` ä¸­æ·»åŠ  `hidden-import` éšè—å¯¼å…¥
3. æŸ¥çœ‹ Nuitka æ–‡æ¡£ï¼šhttps://nuitka.net/doc/

#### Q2: EXE è¿è¡Œæ—¶æç¤ºç¼ºå°‘ DLLï¼Ÿ

**åŸå› **ï¼šæŸäº›ä¾èµ–åº“çš„ DLL æœªæ­£ç¡®æ‰“åŒ…

**è§£å†³**ï¼š
1. æ£€æŸ¥ `--include-data-files` æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…è¦ç›®å½•
2. æ£€æŸ¥ `build.spec` ä¸­çš„ `datas` é…ç½®
3. ç¡®ä¿æ‰€æœ‰ Python æ¨¡å—ä¾èµ–éƒ½å·²å®‰è£…

#### Q3: å¯åŠ¨é€Ÿåº¦æ…¢ï¼Ÿ

**åŸå› **ï¼šé¦–æ¬¡è¿è¡Œéœ€è¦åŠ è½½ç½‘é¡µèµ„æº

**è§£å†³**ï¼š
1. ä½¿ç”¨ `standaloneexefile` æ¨¡å¼ï¼ˆé¦–æ¬¡å¯åŠ¨å¿«ï¼‰
2. æ¥å—é¦–æ¬¡å¯åŠ¨æ…¢æ˜¯æ­£å¸¸çš„
3. æˆ–é¢„åŠ è½½èµ„æºåˆ° EXE ä¸­ï¼ˆä¼šå¢åŠ ä½“ç§¯ï¼‰

#### Q4: æ‰“åŒ…åä½“ç§¯å¾ˆå¤§ï¼Ÿ

**åŸå› **ï¼šåŒ…å«äº†ä¸å¿…è¦çš„æ–‡ä»¶æˆ–æœªå¯ç”¨ä¼˜åŒ–

**è§£å†³**ï¼š
1. æ£€æŸ¥ `.gitignore` æ˜¯å¦æ­£ç¡®æ’é™¤
2. å¯ç”¨ `--lto` å’Œ `--enable-plugin=pgo` ä¼˜åŒ–
3. ä½¿ç”¨ UPX å‹ç¼©ï¼ˆå¯å‡å°‘ 30-50%ï¼‰

---

## ğŸ”§ é…ç½®é€‰é¡¹è¯´æ˜

### build.spec ä¸»è¦é…ç½®

| é€‰é¡¹ | è¯´æ˜ | æ¨èå€¼ |
|------|------|---------|
| mode | æ‰“åŒ…æ¨¡å¼ | standaloneexefile |
| app_name | åº”ç”¨åç§° | JMComicReader |
| version | ç‰ˆæœ¬å· | 1.0.0 |
| entry_point | å…¥å£æ–‡ä»¶ | start.py |
| datas | åŒ…å«çš„ç›®å½• | frontend, backend |
| excludes | æ’é™¤çš„æ–‡ä»¶ | **test*.py |
| options | Nuitka é€‰é¡¹ | å‚è€ƒæ–‡æ¡£ |

---

## ğŸ“ æ‰“åŒ…æµç¨‹å›¾

```
å®‰è£… Nuitka â†’ é…ç½® build.spec â†’ è¿è¡Œ build_exe.py â†’ ç”Ÿæˆ EXE â†’ æµ‹è¯•è¿è¡Œ â†’ æ‰“åŒ…åˆ†å‘
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®éš”ç¦»**
   - æ¯ä¸ª EXE å®ä¾‹ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“æ–‡ä»¶
   - ä¸åŒç”¨æˆ·ä¹‹é—´æ•°æ®ä¸å…±äº«

2. **æ›´æ–°æœºåˆ¶**
   - ç”¨æˆ·éœ€è¦é‡æ–°ä¸‹è½½ EXE æ¥è·å–æ–°ç‰ˆæœ¬
   - å»ºè®®æä¾›è‡ªåŠ¨æ›´æ–°åŠŸèƒ½

3. **å…¼å®¹æ€§**
   - åœ¨ Windows 10/11 ä¸Šæµ‹è¯•
   - ç¡®ä¿æ€æ¯’è½¯ä»¶ä¸è¯¯æŠ¥

4. **æ€§èƒ½**
   - é¦–æ¬¡è¿è¡Œä¼šç¨æ…¢ï¼ˆæ­£å¸¸ï¼‰
   - åç»­å¯åŠ¨é€Ÿåº¦ä¼šå˜å¿«

5. **å‘å¸ƒ**
   - ä½¿ç”¨ä»£ç ç­¾åï¼ˆå¯é€‰ï¼‰
   - åˆ›å»ºå®‰è£…åŒ…ï¼ˆå¯é€‰ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€é”®æ‰“åŒ…ï¼ˆæ¨èï¼‰

```bash
git clone https://github.com/bingking148/JMComicReaderProject.git
cd JMComicReaderProject
pip install -r requirements.txt
python build_exe.py
```

### æ‰“åŒ…å®Œæˆ

1. æ‰“å¼€ `dist` æ–‡ä»¶å¤¹
2. å¤åˆ¶ `JMComicReader.exe` å’Œæ•´ä¸ªé¡¹ç›®åˆ°ç›®æ ‡ç”µè„‘
3. åŒå‡»è¿è¡Œ
4. è®¿é—® http://localhost:5000

---

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

- Nuitka æ–‡æ¡£ï¼šhttps://nuitka.net/doc/
- Nuitka GitHubï¼šhttps://github.com/Nuitka/Nuitka
- æœ¬é¡¹ç›® issuesï¼šhttps://github.com/bingking148/JMComicReaderProject/issues

---

**ğŸ’¡ æç¤º**ï¼šå¦‚æœæ‰“åŒ…é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Python ç‰ˆæœ¬æ˜¯å¦ä¸º 3.11
2. æ‰€æœ‰ä¾èµ–æ˜¯å¦å·²å®‰è£…
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ï¼ˆé¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½ä¾èµ–ï¼‰
